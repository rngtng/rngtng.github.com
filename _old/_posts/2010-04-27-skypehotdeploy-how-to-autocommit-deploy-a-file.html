---
layout: post
status: publish
published: true
title: Skypehotdeploy - How to autocommit & deploy a file
author:
  display_name: tobi
  login: tobi
  email: t.bielohlawek@gmail.com
  url: http://
author_login: tobi
author_email: t.bielohlawek@gmail.com
author_url: http://
wordpress_id: 64
wordpress_url: http://www.rngtng.com/?p=64
date: '2010-04-27 21:49:36 +0000'
date_gmt: '2010-04-27 20:49:36 +0000'
categories:
- Happy Hacking
tags:
- applescript
- hotdeploy
- skype
- subversion
- svn
comments: []
---
<p>At Qype we had the problem of a college sending me a file which needed to get into the development trunk and updated on the production system. Problem was, he had</p>
<p>http://gist.github.com/380749</p>
<p>Skype auto accept file,</p>
<p>folder action on download folder.</p>
<p>[plain]<br />
my hotdeploy()</p>
<p>on adding folder items to this_folder after receiving these_items<br />
my hotdeploy()<br />
end adding folder items to</p>
<p>on hotdeploy()<br />
set usr_home to "/Users/tobiasb/"<br />
set prj_folder to usr_home & "Sites/qype_admin/"<br />
set filename to "report_queries.yml"</p>
<p>set srcs to usr_home & "Downloads/" & filename<br />
set dest to prj_folder & "config/" & filename</p>
<p>try<br />
tell application "Finder" to set file_exists to exists srcs as POSIX file<br />
if file_exists then<br />
say "here we go"<br />
do shell script "mv " & srcs & " " & dest<br />
set diff to do shell script "/opt/local/bin/svn diff " & dest<br />
if not diff is equal to "" then<br />
#set commit to "/opt/local/bin/svn ci --quiet -m'SkypeAutoCommiter: updated report queries' " & dest & ";"<br />
#set hotdeploy to "cd " & prj_folder & "; /usr/bin/cap production qype:hotdeploy FILES=config/" & filename & ";"<br />
#set out to commit & hotdeploy<br />
set out to do shell script "/Users/tobiasb/bin/update_report_queries.sh"<br />
my message("done")<br />
say "done"<br />
else<br />
my message("no changes")<br />
end if<br />
else<br />
return "no file"<br />
end if<br />
on error the error_message number the error_number<br />
my message("error")<br />
say "error"<br />
set the error_text to "Error: " & the error_number & ". " & the error_message<br />
display dialog the error_text buttons {"OK"} default button 1<br />
return the error_text<br />
end try<br />
end hotdeploy</p>
<p>on message(msg)<br />
tell application "Skype" to send command "MESSAGE justalii SkypeAutoCommiter: " & msg script name "to Alli"<br />
#say msg<br />
end message<br />
[/plain]</p>
